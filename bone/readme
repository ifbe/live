;####################real mode area#######################
;这里是BIOS遗留下来的
;"有关这个世界的线索"
;#########################################################
;[0,3ff]    [0,1023]    real mode interrupt vector table
;[400,4ff]    [1024,1279]    bios data area
;[500,5ff]    [1280,1535]    cmos dump from port 0x70 and 0x71
;[600,7ff]    [1536,2047]    memory infomation from e820
;[800,fff]    [2048,4095]    -------------------------
;        800:jmp rax
;		810:where i was born
;		820:gdtr
;		830:idtr




;#######################################################
;这里大部分是不需要看懂的纯数据
;CPU需要这些信息来"做一个好孩子"
;#######################################################
;[1000,1fff]    [4096,8191]    screen infomation
;[2000,2fff]    [8192,12288]    gdt
;[3000,3fff]    [12288,16383]    idt
;[4000,4fff]    [16384,20479]    old page map level 4 -> anscii table
;[5000,5fff]    [20480,24575]    old page directory pointer table -> kbd buffer
;[6000,6fff]    [24576,28671]    old page directory
;[7000,7fff]    [28672,32767]    old page table




;##################pre kernel area######################
;这里必须用汇编，
;因为奇怪的功能用C要多写好长的代码，
;比如直接in/out端口，直接jmp/call物理地址等，
;而且没有必要的交叉混杂被编译器折磨实在浪费生命。
;#####################################################
;[10000,1ffff]    [64k,128k)    pre kernel code
;[20000,2ffff]    [128k,192k)    /acpi
;[30000,3ffff]    [192k,256k)    /anscii
;[40000,4ffff]    [256k,320k)    /pci
;[50000,5ffff]    [320k,384k)    /usb
;[60000,6ffff]    [384k,448k)    /bin
;[70000,7ffff]    [448k,512k)    haven't used
;[80000,8ffff]    [512k,576k)    pd
;[90000,90fff]    [576k,580k)    pml4
;[91000,91fff]    [580k,584k)    pdpt
;[92000~9fff8]:stack




;#################kernel area###########################
;到了这里就是海阔天空啦
;纯C的世界想怎么造都行
;gcc负责翻译成.o文件
;ld负责把一大堆.o文件合成一个.bin给cpu玩
;#######################################################
;[100000,1fffff]    [1m,2m)    kernel code
;[200000,2fffff]    [2m,3m)    ahci
;[300000,3fffff]    [3m,4m)    disk

;[400000,8fffff]    [4m,12m)    --------------------

;[800000,bfffff]    [8m,12m)    1024*1024*rgba pixel data
;[c00000,cfffff]    [12m,13m)    console
;[d00000,dfffff]    [13m,14m)    journal
;[e00000,efffff]    [14m,15m)    something else
;[f00000,ffffff]    [15m,16m)    isa hole




;################free memory##################
;基本上前面的16M空间足够一个内核用了，
;后面就是各种进程管理，网络协议之类的东西，
;linux/mac/windows已经三分天下，不过我只研究意识
;没有本事并且也根本不打算写"操作系统"
;#############################################
;[1000000,?]    [16m,?]    free memory
;......
;......
;......
;......
;[?,?]    [maybe f8000000]    pcie hole
;......
;......
;[fec00000,]    [4g-20m]    typical ioapic
;[fee00000,]    [4g-18m]    localapic;生成的init.bin可以被grub2，bootmgr等加载器直接扔进内存然后裸奔








incbin "core.bin"
times 0x400000-($-$$)db 0
